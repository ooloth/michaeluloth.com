/* see: https://github.com/atomiks/rehype-pretty-code/blob/master/website/src/app/globals.css */
/* see: https://github.com/atomiks/rehype-pretty-code/blob/master/website/tailwind.config.js */

@layer components {
  /* inline code */
  p > code,
  li > code,
  span[data-rehype-pretty-code-fragment] {
    @apply text-[0.87em];

    /* light mode */
    @apply rounded-[0.2em] py-[0.2em] px-[0.3em] bg-zinc-900;

    /* dark mode */
    @apply dark:rounded-none dark:p-0 dark:bg-transparent;
  }

  /* inline code without a language annotation (e.g. `true` instead of `true{:js}` */
  p > code,
  li > code {
    color: #c8d3f5;
  }

  /* code blocks */
  pre {
    @apply mt-6 rounded overflow-x-scroll py-3 px-4 text-[0.85em];

    /* light mode */
    @apply bg-zinc-900;

    /* dark mode */
    @apply dark:bg-zinc-400/5;

    /* see: https://rehype-pretty-code.netlify.app */
    & > code {
      @apply grid;
    }
  }

  /* paragraphs that follow a code block should have a bit more margin above them */
  pre + p,
  div[data-rehype-pretty-code-fragment] + p {
    @apply mt-6;
  }

  [data-line] {
    @apply border-l-2 border-l-transparent;
  }

  [data-highlighted-line] {
    /* light & dark mode */
    background-color: rgba(200, 200, 255, 0.1);
    @apply border-l-blue-400;
  }

  /* TODO: test the following styles in light mode */
  [data-highlighted-chars] {
    @apply bg-zinc-600/50 rounded;
    box-shadow: 0 0 0 4px rgb(82 82 91 / 0.5);

    /* light mode */
    /* dark mode */
  }

  /* display line numbers if code fence includes "showLineNumbers" */
  code[data-line-numbers] {
    counter-reset: line;

    & > [data-line]::before {
      counter-increment: line;
      content: counter(line);

      /* Other styling */
      display: inline-block;
      width: 1rem;
      margin-right: 2rem;
      text-align: right;
      color: gray;
    }
  }

  /* increase width if double digits */
  code[data-line-numbers-max-digits='2'] > [data-line]::before {
    width: 2rem;
  }

  /* increase width if triple digits */
  code[data-line-numbers-max-digits='3'] > [data-line]::before {
    width: 3rem;
  }
}
